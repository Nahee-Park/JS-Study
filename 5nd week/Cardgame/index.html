<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>ì§ë§ì¶”ê¸°</title>
    <style>
      body {
        background: rgb(219, 211, 242);
      }
      header {
        margin-left: 31.2%;
        margin-top: 10%;
        margin-bottom: -70px;
        font-size: 35px;
        color: white;
      }
      #wrapper {
        width: 400px;
        margin-left: 30%;
        margin-top: 10%;
      }
      .card {
        display: inline-block;
        margin-right: 20px;
        margin-bottom: 20px;
        width: 70px;
        height: 100px;
        perspective: 140px;
      }

      .card-inner {
        position: relative;
        width: 100%;
        height: 100%;
        text-align: center;
        transition: transform 0.8s;
        transform-style: preserve-3d;
      }

      .card.flipped .card-inner {
        transform: rotateY(180deg);
      }

      .card-front {
        background: rgb(111, 220, 241);
      }

      .card-front,
      .card-back {
        position: absolute;
        width: 100%;
        height: 100%;
        border: 1px solid black;
        backface-visibility: hidden;
      }

      .card-back {
        transform: rotateY(180deg);
      }
    </style>
  </head>
  <body>
    <header>ğŸ° ì¹´ë“œ ë’¤ì§‘ê¸° ê²Œì„ ğŸ°</header>
    <div id="wrapper"></div>
    <script>
      const $wrapper = document.querySelector("#wrapper");

      const total = 12;
      const colors = ["red", "orange", "yellow", "green", "white", "pink"];
      //ê°™ì€ ìƒ‰ìƒì˜ ì¹´ë“œ ë‘ ì¥ ë§Œë“œë¯€ë¡œ ì „ì²´ ì¹´ë“œëŠ” colorCopy ì•ˆì— ë‹´ê¹€
      let colorCopy = colors.concat(colors);
      let shuffled = []; //ë§ˆêµ¬ì¡ì´ë¡œ ì„ì€ ì¹´ë“œ ë„£ì„ ë°°ì—´ -> colorCopyë¥¼ ë§ˆêµ¬ì¡ì´ë¡œ ë„£ì–´ë‘ 
      let clicked = []; //í´ë¦­ëœ í•¨ìˆ˜ ë„£ì„ ë°°ì—´
      let completed = [];
      let clickable = false;

      function shuffle() {
        // í”¼ì…”-ì˜ˆì´ì¸  ì…”í”Œ
        for (let i = 0; colorCopy.length > 0; i += 1) {
          const randomIndex = Math.floor(Math.random() * colorCopy.length); //ëœë¤í•œ ê±° í•˜ë‚˜ ë½‘ìŒ
          shuffled = shuffled.concat(colorCopy.splice(randomIndex, 1)); //newArr = arr.splice(3,1); ì€ 3ë²ˆì§¸ ì¸ë±ìŠ¤ì˜ ì›ì†Œ 1ê°œë¼ëŠ” ëœ»
        }
      }

      //í•˜ë‚˜ì˜ ì¹´ë“œë¥¼ ìƒì„±í•˜ëŠ” í•¨ìˆ˜. iëŠ” ë§ˆêµ¬ì¡ì´ë¡œ ì„ì€ ì¹´ë“œ ë°°ì—´ì¸ shuffledì˜ ëª‡ë²ˆì§¸ ì¸ë±ìŠ¤ì¸ì§€ë¥¼ ì§€ì¹­í•  ì¸ë±ìŠ¤ ë³€ìˆ˜
      function createCard(i) {
        // div.card > div.card-inner > (div.card-front + div.card-back)
        const card = document.createElement("div");
        card.className = "card"; // .card íƒœê·¸ ìƒì„±
        const cardInner = document.createElement("div");
        cardInner.className = "card-inner"; // .card-inner íƒœê·¸ ìƒì„±
        const cardFront = document.createElement("div");
        cardFront.className = "card-front"; // .card-front íƒœê·¸ ìƒì„±
        const cardBack = document.createElement("div");
        cardBack.className = "card-back"; // .card-back íƒœê·¸ ìƒì„±
        cardBack.style.backgroundColor = shuffled[i]; //backgroundColorì„ shuffledë°°ì—´ì—ì„œ ê°€ì ¸ì˜´
        cardInner.appendChild(cardFront);
        cardInner.appendChild(cardBack);
        card.appendChild(cardInner);
        return card;
      }

      /*ì¹´ë“œ í´ë¦­í•¨ìˆ˜, ê²Œì„ì‹œì‘ í•¨ìˆ˜, ì¹´ë“œ ë¦¬ì…‹ í•¨ìˆ˜*/
      // clicked : [2, 5, 8, 9]
      // íƒœìŠ¤í¬í:
      // ë°±: addEventListener(12),
      function onClickCard() {
        //.includesëŠ” ë°°ì—´ì´ íŠ¹ì • ìš”ì†Œ ê°–ê³  ìˆëŠ”ì§€ íŒë³„
        //ì…‹ ì¤‘ í•˜ë‚˜ì˜ ì¡°ê±´ì´ë¼ë„ ìˆìœ¼ë©´ onClickCard()ëŠ” ì‹¤í–‰ë˜ì§€ ì•ŠìŒ
        if (!clickable || completed.includes(this) || clicked[0] === this) {
          return;
        }

        //í´ë¦­ëœ ì¹´ë“œì— flippedí´ë˜ìŠ¤ ì¶”ê°€í•˜ê³  ê·¸ ì¹´ë“œë¥¼ clicked ë°°ì—´ì— ë„£ìŒ
        this.classList.toggle("flipped");
        clicked.push(this);
        if (clicked.length !== 2) {
          return;
        }
        const firstBackColor =
          clicked[0].querySelector(".card-back").style.backgroundColor;
        const secondBackColor =
          clicked[1].querySelector(".card-back").style.backgroundColor;
        if (firstBackColor === secondBackColor) {
          // ë‘ ì¹´ë“œê°€ ê°™ì€ ì¹´ë“œë©´
          //completedì•ˆì— í´ë¦­í•œ ì¹´ë“œ ë„£ê³  í´ë¦­í•œ ì¹´ë“œ ì´ˆê¸°í™”
          completed.push(clicked[0]);
          completed.push(clicked[1]);
          clicked = [];
          //ë§Œì•½ completed ë°°ì—´ì´ ê½‰ ì°¨ë©´ ì¶•í•˜í•©ë‹ˆë‹¤
          if (completed.length !== total) {
            return;
          }
          setTimeout(() => {
            alert(`ì¶•í•˜í•©ë‹ˆë‹¤!`);
            resetGame();
          }, 1000);
          return;
        }
        //ì„±ê³µí•˜ê³  ë‚˜ì„  ìš°ì„  í´ë¦­ ëª»í•˜ê²Œ í•¨
        clickable = false;
        //ìƒ‰ì´ ê°™ì´ ì•Šìœ¼ë©´ flipped í´ë˜ìŠ¤ ì—†ì• ì„œ ë‹¤ì‹œ ë˜ëŒë¦¬ê¸°
        setTimeout(() => {
          clicked[0].classList.remove("flipped");
          clicked[1].classList.remove("flipped");
          //í´ë¦­í•œ ì•  ì´ˆê¸°í™”
          clicked = [];
          //ë‹¤ì‹œ í´ë¦­í•  ìˆ˜ ìˆë„ë¡
          clickable = true;
        }, 500);
      }

      function startGame() {
        //ìš°ì„  í´ë¦­ ë¶ˆê°€ëŠ¥í•˜ê²Œ falseë¡œ ì„ ì–¸ì„ í•´ë‘ 
        clickable = false;
        //ì•ì„œ ì •ì˜í•œ shuffleë¡œ ì¹´ë“œ ì„ìŒ
        shuffle();
        for (let i = 0; i < total; i += 1) {
          const card = createCard(i);
          card.addEventListener("click", onClickCard);
          $wrapper.appendChild(card);
        }
        // ì´ˆë°˜ ì¹´ë“œ ê³µê°œ ìˆœì°¨ì ìœ¼ë¡œ ë˜ë„ë¡ -> flippedí´ë˜ìŠ¤ë¥¼ ì¶”ê°€í•˜ë©´ ëŒì•„ê°€ë„ë¡ cssì„¤ì •
        document.querySelectorAll(".card").forEach((card, index) => {
          setTimeout(() => {
            card.classList.add("flipped");
          }, 1000 + 100 * index);
        });

        //ì¹´ë“œ ìˆœì°¨ì ìœ¼ë¡œ ê°ì¶”ë„ë¡ -> flippedí´ë˜ìŠ¤ ì œê±°í•˜ë©´ ëŒì•„ê°€ìˆëŠ” ì¹´ë“œ ì œìë¦¬ë¡œ ëŒì•„ê°
        setTimeout(() => {
          // ì¹´ë“œ ê°ì¶”ê¸°
          document.querySelectorAll(".card").forEach((card) => {
            card.classList.remove("flipped");
          });
          clickable = true;
        }, 5000);
      }
      startGame(); //ìš°ì„  startê²Œì„ì„ í•¨

      function resetGame() {
        //ë‹¤ì‹œ wrapper ì•ˆì˜ ìƒíƒœ ë¦¬ì…‹
        $wrapper.innerHTML = "";
        //ë‹¤ì‹œ colorCopy ìƒì„±
        colorCopy = colors.concat(colors);
        //ë§ˆêµ¬ì¡ì´ë¡œ colorCopyë„£ì„ ë°°ì—´ê³¼ ì™„ë£Œëœ ê±° ë„£ì„ ë°°ì—´ ì´ˆê¸°í™”í•˜ê³  startGameì„ ë‹¤ì‹œ í•¨.
        shuffled = [];
        completed = [];
        startGame();
      }
    </script>
  </body>
</html>
